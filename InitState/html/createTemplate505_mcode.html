<pre class="code">
<span class="srcline"><span class="lineno"><a href="104,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%% create edge template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,8" id="srcline8">  8</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T4U3">TEMPLATE</span>] = createTemplate( <span class="var type1" id="S3T9U6">H</span> ,<span class="var type1" id="S4T9U7">W</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="104,9" id="srcline9">  9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">%% empty template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,11" id="srcline11"> 11</a></span><span class="line">    <span class="mxinfo " id="T4:U4"><span class="var type1" id="S2T4U10">TEMPLATE</span> = <span class="mxinfo " id="T4:U6"><span class="mxinfo " id="T1:U7">-180</span> * <span class="mxinfo " id="T4:U8">ones( <span class="mxinfo " id="T9:U9"><span class="mxinfo " id="T9:U10">2*<span class="var type1" id="S3T9U19">H</span></span>+<span class="mxinfo " id="T1:U12">1</span></span>, <span class="mxinfo " id="T9:U13"><span class="mxinfo " id="T9:U14">2*<span class="var type1" id="S4T9U24">W</span></span>+<span class="mxinfo " id="T1:U16">1</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo " id="T40:U17"><span class="var type1" id="S6T40U28">pix</span>      = <span class="mxinfo " id="T40:U19">[<span class="mxinfo " id="T13:U20"><span class="mxinfo " id="T9:U21">-2*<span class="var type1" id="S4T9U35">W</span></span>:<span class="mxinfo " id="T9:U23">2*<span class="var type1" id="S4T9U38">W</span></span></span>;<span class="mxinfo " id="T15:U25">zeros(<span class="mxinfo " id="T1:U26">1</span>,<span class="mxinfo " id="T9:U27"><span class="mxinfo " id="T9:U28">4*<span class="var type1" id="S4T9U46">W</span></span>+<span class="mxinfo " id="T1:U30">1</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,13" id="srcline13"> 13</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="104,14" id="srcline14"> 14</a></span><span class="line">    <span class="comment">%% left border</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,15" id="srcline15"> 15</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T9U50">h</span> = <span class="mxinfo " id="T9:U32"><span class="var type1" id="S3T9U53">H</span>+<span class="mxinfo " id="T1:U34">1</span></span>:<span class="mxinfo " id="T9:U35"><span class="mxinfo " id="T9:U36">2*<span class="var type1" id="S3T9U58">H</span></span>+<span class="mxinfo " id="T1:U38">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="104,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,17" id="srcline17"> 17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,18" id="srcline18"> 18</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,19" id="srcline19"> 19</a></span><span class="line">        <span class="mxinfo " id="T9:U39"><span class="var type1" id="S9T9U62">an</span> = <span class="mxinfo " id="T9:U41">atan(<span class="mxinfo " id="T9:U42">(<span class="mxinfo " id="T9:U43"><span class="var type1" id="S8T9U68">h</span>-(<span class="mxinfo " id="T9:U45"><span class="var type1" id="S3T9U71">H</span>+<span class="mxinfo " id="T1:U47">1</span></span>)</span>) / <span class="var type1" id="S4T9U73">W</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,20" id="srcline20"> 20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,21" id="srcline21"> 21</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,22" id="srcline22"> 22</a></span><span class="line">        <span class="mxinfo " id="T9:U49"><span class="var type1" id="S11T9U76">cs</span>     = <span class="mxinfo " id="T9:U51">cos(<span class="mxinfo " id="T9:U52">-<span class="var type1" id="S9T9U80">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,23" id="srcline23"> 23</a></span><span class="line">        <span class="mxinfo " id="T9:U54"><span class="var type1" id="S13T9U83">sn</span>     = <span class="mxinfo " id="T9:U56">sin(<span class="mxinfo " id="T9:U57">-<span class="var type1" id="S9T9U87">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,24" id="srcline24"> 24</a></span><span class="line">        <span class="mxinfo " id="T47:U59"><span class="var type1" id="S15T47U90">rot</span>    = <span class="mxinfo " id="T47:U61">[<span class="mxinfo " id="T8:U62"><span class="var type1" id="S11T9U93">cs</span> <span class="mxinfo " id="T9:U64">-<span class="var type1" id="S13T9U95">sn</span></span></span>; <span class="mxinfo " id="T8:U66"><span class="var type1" id="S13T9U97">sn</span> <span class="var type1" id="S11T9U98">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,25" id="srcline25"> 25</a></span><span class="line">        <span class="mxinfo " id="T40:U69"><span class="var type1" id="S16T40U101">pixrot</span> = <span class="mxinfo " id="T40:U71"><span class="var type1" id="S15T47U103">rot</span>*<span class="var type1" id="S6T40U104">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,26" id="srcline26"> 26</a></span><span class="line">        <span class="mxinfo " id="T13:U74"><span class="mxinfo " id="T13:U75"><span class="var type1" id="S16T40U108">pixrot</span>(<span class="mxinfo " id="T12:U77">1</span>,<span class="mxinfo " id="T14:U78">:</span>)</span> = <span class="mxinfo " id="T13:U79"><span class="mxinfo " id="T13:U80"><span class="mxinfo " id="T13:U81"><span class="var type1" id="S16T40U114">pixrot</span>(<span class="mxinfo " id="T1:U83">1</span>,<span class="mxinfo " id="T14:U84">:</span>)</span> + <span class="var type1" id="S4T9U117">W</span></span>+<span class="mxinfo " id="T1:U86">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,27" id="srcline27"> 27</a></span><span class="line">        <span class="mxinfo " id="T13:U87"><span class="mxinfo " id="T13:U88"><span class="var type1" id="S16T40U122">pixrot</span>(<span class="mxinfo " id="T12:U90">2</span>,<span class="mxinfo " id="T14:U91">:</span>)</span> = <span class="mxinfo " id="T13:U92"><span class="mxinfo " id="T13:U93"><span class="mxinfo " id="T13:U94"><span class="var type1" id="S16T40U128">pixrot</span>(<span class="mxinfo " id="T1:U96">2</span>,<span class="mxinfo " id="T14:U97">:</span>)</span> + <span class="var type1" id="S3T9U131">H</span></span>+<span class="mxinfo " id="T1:U99">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,28" id="srcline28"> 28</a></span><span class="line">        <span class="mxinfo " id="T40:U100"><span class="var type1" id="S16T40U135">pixrot</span>      = <span class="mxinfo " id="T40:U102"><span class="var type1" id="S16T40U137">pixrot</span>(<span class="mxinfo " id="T50:U104">:</span>, <span class="mxinfo " id="T115:U105"><span class="mxinfo " id="T115:U106"><span class="mxinfo " id="T115:U107">(<span class="mxinfo " id="T115:U108"><span class="mxinfo " id="T1:U109">1</span> &lt;= <span class="mxinfo " id="T13:U110"><span class="var type1" id="S16T40U146">pixrot</span>(<span class="mxinfo " id="T1:U112">1</span>,<span class="mxinfo " id="T14:U113">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T115:U114"><span class="mxinfo " id="T13:U115"><span class="var type1" id="S16T40U152">pixrot</span>(<span class="mxinfo " id="T1:U117">1</span>,<span class="mxinfo " id="T14:U118">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U119"><span class="mxinfo " id="T9:U120">2*<span class="var type1" id="S4T9U158">W</span></span>+<span class="mxinfo " id="T1:U122">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T115:U123"><span class="mxinfo " id="T1:U124">1</span> &lt;= <span class="mxinfo " id="T13:U125"><span class="var type1" id="S16T40U164">pixrot</span>(<span class="mxinfo " id="T1:U127">2</span>,<span class="mxinfo " id="T14:U128">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T115:U129"><span class="mxinfo " id="T13:U130"><span class="var type1" id="S16T40U170">pixrot</span>(<span class="mxinfo " id="T1:U132">2</span>,<span class="mxinfo " id="T14:U133">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U134"><span class="mxinfo " id="T9:U135">2*<span class="var type1" id="S3T9U176">H</span></span>+<span class="mxinfo " id="T1:U137">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,29" id="srcline29"> 29</a></span><span class="line">        <span class="mxinfo " id="T40:U138"><span class="var type1" id="S16T40U180">pixrot</span>      = <span class="mxinfo " id="T40:U140">round(<span class="var type1" id="S16T40U183">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,30" id="srcline30"> 30</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,31" id="srcline31"> 31</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,32" id="srcline32"> 32</a></span><span class="line">        <span class="mxinfo " id="T15:U142"><span class="var type1" id="S18T15U186">index</span> = <span class="mxinfo " id="T15:U144">sub2ind(<span class="mxinfo " id="T8:U145">[<span class="mxinfo " id="T9:U146"><span class="mxinfo " id="T9:U147">2*<span class="var type1" id="S3T9U194">H</span></span>+<span class="mxinfo " id="T1:U149">1</span></span>, <span class="mxinfo " id="T9:U150"><span class="mxinfo " id="T9:U151">2*<span class="var type1" id="S4T9U199">W</span></span>+<span class="mxinfo " id="T1:U153">1</span></span>]</span>, <span class="mxinfo " id="T13:U154"><span class="var type1" id="S16T40U202">pixrot</span>(<span class="mxinfo " id="T12:U156">2</span>,<span class="mxinfo " id="T14:U157">:</span>)</span>, <span class="mxinfo " id="T13:U158"><span class="var type1" id="S16T40U206">pixrot</span>(<span class="mxinfo " id="T12:U160">1</span>,<span class="mxinfo " id="T14:U161">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,33" id="srcline33"> 33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,34" id="srcline34"> 34</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,35" id="srcline35"> 35</a></span><span class="line">        <span class="mxinfo " id="T15:U162"><span class="mxinfo " id="T15:U163"><span class="var type1" id="S2T4U212">TEMPLATE</span>(<span class="var type1" id="S18T15U213">index</span>)</span> = <span class="mxinfo " id="T9:U166">rad2deg(<span class="var type1" id="S9T9U216">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="104,36" id="srcline36"> 36</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,37" id="srcline37"> 37</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="104,38" id="srcline38"> 38</a></span><span class="line">    <span class="comment">%% bottom border left part</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,39" id="srcline39"> 39</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T9U219">w</span> = <span class="var type1" id="S4T9U222">W</span>:<span class="mxinfo " id="T9:U170">-1</span>:<span class="mxinfo " id="T9:U171">0</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,40" id="srcline40"> 40</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="104,41" id="srcline41"> 41</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,42" id="srcline42"> 42</a></span><span class="line">        <span class="mxinfo " id="T9:U172"><span class="var type1" id="S9T9U228">an</span> = <span class="mxinfo " id="T9:U174"><span class="mxinfo " id="T1:U175"><span class="mxinfo " id="T1:U176">pi</span>/<span class="mxinfo " id="T1:U177">2</span></span>-<span class="mxinfo " id="T9:U178">atan( <span class="mxinfo " id="T9:U179"><span class="var type1" id="S21T9U237">w</span> / <span class="var type1" id="S3T9U238">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,43" id="srcline43"> 43</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,44" id="srcline44"> 44</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,45" id="srcline45"> 45</a></span><span class="line">        <span class="mxinfo " id="T9:U182"><span class="var type1" id="S11T9U241">cs</span>     = <span class="mxinfo " id="T9:U184">cos(<span class="mxinfo " id="T9:U185">-<span class="var type1" id="S9T9U245">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,46" id="srcline46"> 46</a></span><span class="line">        <span class="mxinfo " id="T9:U187"><span class="var type1" id="S13T9U248">sn</span>     = <span class="mxinfo " id="T9:U189">sin(<span class="mxinfo " id="T9:U190">-<span class="var type1" id="S9T9U252">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,47" id="srcline47"> 47</a></span><span class="line">        <span class="mxinfo " id="T47:U192"><span class="var type1" id="S15T47U255">rot</span>    = <span class="mxinfo " id="T47:U194">[<span class="mxinfo " id="T8:U195"><span class="var type1" id="S11T9U258">cs</span> <span class="mxinfo " id="T9:U197">-<span class="var type1" id="S13T9U260">sn</span></span></span>; <span class="mxinfo " id="T8:U199"><span class="var type1" id="S13T9U262">sn</span> <span class="var type1" id="S11T9U263">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,48" id="srcline48"> 48</a></span><span class="line">        <span class="mxinfo " id="T40:U202"><span class="var type1" id="S16T40U266">pixrot</span> = <span class="mxinfo " id="T40:U204"><span class="var type1" id="S15T47U268">rot</span>*<span class="var type1" id="S6T40U269">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,49" id="srcline49"> 49</a></span><span class="line">        <span class="mxinfo " id="T13:U207"><span class="mxinfo " id="T13:U208"><span class="var type1" id="S16T40U273">pixrot</span>(<span class="mxinfo " id="T12:U210">1</span>,<span class="mxinfo " id="T14:U211">:</span>)</span> = <span class="mxinfo " id="T13:U212"><span class="mxinfo " id="T13:U213"><span class="mxinfo " id="T13:U214"><span class="var type1" id="S16T40U279">pixrot</span>(<span class="mxinfo " id="T1:U216">1</span>,<span class="mxinfo " id="T14:U217">:</span>)</span> + <span class="var type1" id="S4T9U282">W</span></span>+<span class="mxinfo " id="T1:U219">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,50" id="srcline50"> 50</a></span><span class="line">        <span class="mxinfo " id="T13:U220"><span class="mxinfo " id="T13:U221"><span class="var type1" id="S16T40U287">pixrot</span>(<span class="mxinfo " id="T12:U223">2</span>,<span class="mxinfo " id="T14:U224">:</span>)</span> = <span class="mxinfo " id="T13:U225"><span class="mxinfo " id="T13:U226"><span class="mxinfo " id="T13:U227"><span class="var type1" id="S16T40U293">pixrot</span>(<span class="mxinfo " id="T1:U229">2</span>,<span class="mxinfo " id="T14:U230">:</span>)</span> + <span class="var type1" id="S3T9U296">H</span></span>+<span class="mxinfo " id="T1:U232">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,51" id="srcline51"> 51</a></span><span class="line">        <span class="mxinfo " id="T40:U233"><span class="var type1" id="S16T40U300">pixrot</span>      = <span class="mxinfo " id="T40:U235"><span class="var type1" id="S16T40U302">pixrot</span>(<span class="mxinfo " id="T50:U237">:</span>, <span class="mxinfo " id="T115:U238"><span class="mxinfo " id="T115:U239"><span class="mxinfo " id="T115:U240">(<span class="mxinfo " id="T115:U241"><span class="mxinfo " id="T1:U242">1</span> &lt;= <span class="mxinfo " id="T13:U243"><span class="var type1" id="S16T40U311">pixrot</span>(<span class="mxinfo " id="T1:U245">1</span>,<span class="mxinfo " id="T14:U246">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T115:U247"><span class="mxinfo " id="T13:U248"><span class="var type1" id="S16T40U317">pixrot</span>(<span class="mxinfo " id="T1:U250">1</span>,<span class="mxinfo " id="T14:U251">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U252"><span class="mxinfo " id="T9:U253">2*<span class="var type1" id="S4T9U323">W</span></span>+<span class="mxinfo " id="T1:U255">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T115:U256"><span class="mxinfo " id="T1:U257">1</span> &lt;= <span class="mxinfo " id="T13:U258"><span class="var type1" id="S16T40U329">pixrot</span>(<span class="mxinfo " id="T1:U260">2</span>,<span class="mxinfo " id="T14:U261">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T115:U262"><span class="mxinfo " id="T13:U263"><span class="var type1" id="S16T40U335">pixrot</span>(<span class="mxinfo " id="T1:U265">2</span>,<span class="mxinfo " id="T14:U266">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U267"><span class="mxinfo " id="T9:U268">2*<span class="var type1" id="S3T9U341">H</span></span>+<span class="mxinfo " id="T1:U270">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,52" id="srcline52"> 52</a></span><span class="line">        <span class="mxinfo " id="T40:U271"><span class="var type1" id="S16T40U345">pixrot</span>      = <span class="mxinfo " id="T40:U273">round(<span class="var type1" id="S16T40U348">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,53" id="srcline53"> 53</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,54" id="srcline54"> 54</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,55" id="srcline55"> 55</a></span><span class="line">        <span class="mxinfo " id="T15:U275"><span class="var type1" id="S18T15U351">index</span> = <span class="mxinfo " id="T15:U277">sub2ind(<span class="mxinfo " id="T8:U278">[<span class="mxinfo " id="T9:U279"><span class="mxinfo " id="T9:U280">2*<span class="var type1" id="S3T9U359">H</span></span>+<span class="mxinfo " id="T1:U282">1</span></span>, <span class="mxinfo " id="T9:U283"><span class="mxinfo " id="T9:U284">2*<span class="var type1" id="S4T9U364">W</span></span>+<span class="mxinfo " id="T1:U286">1</span></span>]</span>, <span class="mxinfo " id="T13:U287"><span class="var type1" id="S16T40U367">pixrot</span>(<span class="mxinfo " id="T12:U289">2</span>,<span class="mxinfo " id="T14:U290">:</span>)</span>, <span class="mxinfo " id="T13:U291"><span class="var type1" id="S16T40U371">pixrot</span>(<span class="mxinfo " id="T12:U293">1</span>,<span class="mxinfo " id="T14:U294">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,56" id="srcline56"> 56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,57" id="srcline57"> 57</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,58" id="srcline58"> 58</a></span><span class="line">        <span class="mxinfo " id="T15:U295"><span class="mxinfo " id="T15:U296"><span class="var type1" id="S2T4U377">TEMPLATE</span>(<span class="var type1" id="S18T15U378">index</span>)</span> = <span class="mxinfo " id="T9:U299">rad2deg(<span class="var type1" id="S9T9U381">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="104,59" id="srcline59"> 59</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,61" id="srcline61"> 61</a></span><span class="line">    <span class="comment">%% bottom border rithg part</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,62" id="srcline62"> 62</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T9U384">w</span> = <span class="var type1" id="S4T9U387">W</span>:<span class="mxinfo " id="T9:U303">-1</span>:<span class="mxinfo " id="T9:U304">0</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,63" id="srcline63"> 63</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="104,64" id="srcline64"> 64</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,65" id="srcline65"> 65</a></span><span class="line">        <span class="mxinfo " id="T9:U305"><span class="var type1" id="S9T9U393">an</span> = <span class="mxinfo " id="T9:U307"><span class="mxinfo " id="T1:U308"><span class="mxinfo " id="T1:U309">pi</span>/<span class="mxinfo " id="T1:U310">2</span></span>+<span class="mxinfo " id="T9:U311">atan( <span class="mxinfo " id="T9:U312"><span class="var type1" id="S21T9U402">w</span> / <span class="var type1" id="S3T9U403">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,66" id="srcline66"> 66</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,67" id="srcline67"> 67</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,68" id="srcline68"> 68</a></span><span class="line">        <span class="mxinfo " id="T9:U315"><span class="var type1" id="S11T9U406">cs</span>     = <span class="mxinfo " id="T9:U317">cos(<span class="mxinfo " id="T9:U318">-<span class="var type1" id="S9T9U410">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,69" id="srcline69"> 69</a></span><span class="line">        <span class="mxinfo " id="T9:U320"><span class="var type1" id="S13T9U413">sn</span>     = <span class="mxinfo " id="T9:U322">sin(<span class="mxinfo " id="T9:U323">-<span class="var type1" id="S9T9U417">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,70" id="srcline70"> 70</a></span><span class="line">        <span class="mxinfo " id="T47:U325"><span class="var type1" id="S15T47U420">rot</span>    = <span class="mxinfo " id="T47:U327">[<span class="mxinfo " id="T8:U328"><span class="var type1" id="S11T9U423">cs</span> <span class="mxinfo " id="T9:U330">-<span class="var type1" id="S13T9U425">sn</span></span></span>; <span class="mxinfo " id="T8:U332"><span class="var type1" id="S13T9U427">sn</span> <span class="var type1" id="S11T9U428">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,71" id="srcline71"> 71</a></span><span class="line">        <span class="mxinfo " id="T40:U335"><span class="var type1" id="S16T40U431">pixrot</span> = <span class="mxinfo " id="T40:U337"><span class="var type1" id="S15T47U433">rot</span>*<span class="var type1" id="S6T40U434">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,72" id="srcline72"> 72</a></span><span class="line">        <span class="mxinfo " id="T13:U340"><span class="mxinfo " id="T13:U341"><span class="var type1" id="S16T40U438">pixrot</span>(<span class="mxinfo " id="T12:U343">1</span>,<span class="mxinfo " id="T14:U344">:</span>)</span> = <span class="mxinfo " id="T13:U345"><span class="mxinfo " id="T13:U346"><span class="mxinfo " id="T13:U347"><span class="var type1" id="S16T40U444">pixrot</span>(<span class="mxinfo " id="T1:U349">1</span>,<span class="mxinfo " id="T14:U350">:</span>)</span> + <span class="var type1" id="S4T9U447">W</span></span>+<span class="mxinfo " id="T1:U352">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo " id="T13:U353"><span class="mxinfo " id="T13:U354"><span class="var type1" id="S16T40U452">pixrot</span>(<span class="mxinfo " id="T12:U356">2</span>,<span class="mxinfo " id="T14:U357">:</span>)</span> = <span class="mxinfo " id="T13:U358"><span class="mxinfo " id="T13:U359"><span class="mxinfo " id="T13:U360"><span class="var type1" id="S16T40U458">pixrot</span>(<span class="mxinfo " id="T1:U362">2</span>,<span class="mxinfo " id="T14:U363">:</span>)</span> + <span class="var type1" id="S3T9U461">H</span></span>+<span class="mxinfo " id="T1:U365">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,74" id="srcline74"> 74</a></span><span class="line">        <span class="mxinfo " id="T40:U366"><span class="var type1" id="S16T40U465">pixrot</span>      = <span class="mxinfo " id="T40:U368"><span class="var type1" id="S16T40U467">pixrot</span>(<span class="mxinfo " id="T50:U370">:</span>, <span class="mxinfo " id="T115:U371"><span class="mxinfo " id="T115:U372"><span class="mxinfo " id="T115:U373">(<span class="mxinfo " id="T115:U374"><span class="mxinfo " id="T1:U375">1</span> &lt;= <span class="mxinfo " id="T13:U376"><span class="var type1" id="S16T40U476">pixrot</span>(<span class="mxinfo " id="T1:U378">1</span>,<span class="mxinfo " id="T14:U379">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T115:U380"><span class="mxinfo " id="T13:U381"><span class="var type1" id="S16T40U482">pixrot</span>(<span class="mxinfo " id="T1:U383">1</span>,<span class="mxinfo " id="T14:U384">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U385"><span class="mxinfo " id="T9:U386">2*<span class="var type1" id="S4T9U488">W</span></span>+<span class="mxinfo " id="T1:U388">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T115:U389"><span class="mxinfo " id="T1:U390">1</span> &lt;= <span class="mxinfo " id="T13:U391"><span class="var type1" id="S16T40U494">pixrot</span>(<span class="mxinfo " id="T1:U393">2</span>,<span class="mxinfo " id="T14:U394">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T115:U395"><span class="mxinfo " id="T13:U396"><span class="var type1" id="S16T40U500">pixrot</span>(<span class="mxinfo " id="T1:U398">2</span>,<span class="mxinfo " id="T14:U399">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U400"><span class="mxinfo " id="T9:U401">2*<span class="var type1" id="S3T9U506">H</span></span>+<span class="mxinfo " id="T1:U403">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,75" id="srcline75"> 75</a></span><span class="line">        <span class="mxinfo " id="T40:U404"><span class="var type1" id="S16T40U510">pixrot</span>      = <span class="mxinfo " id="T40:U406">round(<span class="var type1" id="S16T40U513">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,76" id="srcline76"> 76</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,77" id="srcline77"> 77</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,78" id="srcline78"> 78</a></span><span class="line">        <span class="mxinfo " id="T15:U408"><span class="var type1" id="S18T15U516">index</span> = <span class="mxinfo " id="T15:U410">sub2ind(<span class="mxinfo " id="T8:U411">[<span class="mxinfo " id="T9:U412"><span class="mxinfo " id="T9:U413">2*<span class="var type1" id="S3T9U524">H</span></span>+<span class="mxinfo " id="T1:U415">1</span></span>, <span class="mxinfo " id="T9:U416"><span class="mxinfo " id="T9:U417">2*<span class="var type1" id="S4T9U529">W</span></span>+<span class="mxinfo " id="T1:U419">1</span></span>]</span>, <span class="mxinfo " id="T13:U420"><span class="var type1" id="S16T40U532">pixrot</span>(<span class="mxinfo " id="T12:U422">2</span>,<span class="mxinfo " id="T14:U423">:</span>)</span>, <span class="mxinfo " id="T13:U424"><span class="var type1" id="S16T40U536">pixrot</span>(<span class="mxinfo " id="T12:U426">1</span>,<span class="mxinfo " id="T14:U427">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,80" id="srcline80"> 80</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,81" id="srcline81"> 81</a></span><span class="line">        <span class="mxinfo " id="T15:U428"><span class="mxinfo " id="T15:U429"><span class="var type1" id="S2T4U542">TEMPLATE</span>(<span class="var type1" id="S18T15U543">index</span>)</span> = <span class="mxinfo " id="T9:U432">rad2deg(<span class="var type1" id="S9T9U546">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="104,82" id="srcline82"> 82</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,83" id="srcline83"> 83</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,84" id="srcline84"> 84</a></span><span class="line">    <span class="comment">%% right border</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo " id="T40:U434"><span class="var type1" id="S6T40U549">pix</span> = <span class="mxinfo " id="T40:U436">[<span class="mxinfo " id="T13:U437"><span class="mxinfo " id="T9:U438">-2*<span class="var type1" id="S4T9U556">W</span></span>:<span class="mxinfo " id="T9:U440">2*<span class="var type1" id="S4T9U559">W</span></span></span>;<span class="mxinfo " id="T15:U442">zeros(<span class="mxinfo " id="T1:U443">1</span>,<span class="mxinfo " id="T9:U444"><span class="mxinfo " id="T9:U445">4*<span class="var type1" id="S4T9U567">W</span></span>+<span class="mxinfo " id="T1:U447">1</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,86" id="srcline86"> 86</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T9U571">h</span> = <span class="mxinfo " id="T9:U449"><span class="var type1" id="S3T9U574">H</span>+<span class="mxinfo " id="T1:U451">1</span></span>:<span class="mxinfo " id="T9:U452"><span class="mxinfo " id="T9:U453">2*<span class="var type1" id="S3T9U579">H</span></span>+<span class="mxinfo " id="T1:U455">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="104,87" id="srcline87"> 87</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,88" id="srcline88"> 88</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,89" id="srcline89"> 89</a></span><span class="line">        <span class="mxinfo " id="T9:U456"><span class="var type1" id="S9T9U583">an</span> = <span class="mxinfo " id="T9:U458"><span class="mxinfo " id="T1:U459">pi</span>-<span class="mxinfo " id="T9:U460">atan( <span class="mxinfo " id="T9:U461">(<span class="mxinfo " id="T9:U462"><span class="var type1" id="S8T9U592">h</span>-(<span class="mxinfo " id="T9:U464"><span class="var type1" id="S3T9U595">H</span>+<span class="mxinfo " id="T1:U466">1</span></span>)</span>) / <span class="var type1" id="S4T9U597">W</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,90" id="srcline90"> 90</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,91" id="srcline91"> 91</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,92" id="srcline92"> 92</a></span><span class="line">        <span class="mxinfo " id="T9:U468"><span class="var type1" id="S11T9U600">cs</span>     = <span class="mxinfo " id="T9:U470">cos(<span class="mxinfo " id="T9:U471">-<span class="var type1" id="S9T9U604">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,93" id="srcline93"> 93</a></span><span class="line">        <span class="mxinfo " id="T9:U473"><span class="var type1" id="S13T9U607">sn</span>     = <span class="mxinfo " id="T9:U475">sin(<span class="mxinfo " id="T9:U476">-<span class="var type1" id="S9T9U611">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,94" id="srcline94"> 94</a></span><span class="line">        <span class="mxinfo " id="T47:U478"><span class="var type1" id="S15T47U614">rot</span>    = <span class="mxinfo " id="T47:U480">[<span class="mxinfo " id="T8:U481"><span class="var type1" id="S11T9U617">cs</span> <span class="mxinfo " id="T9:U483">-<span class="var type1" id="S13T9U619">sn</span></span></span>; <span class="mxinfo " id="T8:U485"><span class="var type1" id="S13T9U621">sn</span> <span class="var type1" id="S11T9U622">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,95" id="srcline95"> 95</a></span><span class="line">        <span class="mxinfo " id="T40:U488"><span class="var type1" id="S16T40U625">pixrot</span> = <span class="mxinfo " id="T40:U490"><span class="var type1" id="S15T47U627">rot</span>*<span class="var type1" id="S6T40U628">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,96" id="srcline96"> 96</a></span><span class="line">        <span class="mxinfo " id="T13:U493"><span class="mxinfo " id="T13:U494"><span class="var type1" id="S16T40U632">pixrot</span>(<span class="mxinfo " id="T12:U496">1</span>,<span class="mxinfo " id="T14:U497">:</span>)</span> = <span class="mxinfo " id="T13:U498"><span class="mxinfo " id="T13:U499"><span class="mxinfo " id="T13:U500"><span class="var type1" id="S16T40U638">pixrot</span>(<span class="mxinfo " id="T1:U502">1</span>,<span class="mxinfo " id="T14:U503">:</span>)</span> + <span class="var type1" id="S4T9U641">W</span></span>+<span class="mxinfo " id="T1:U505">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,97" id="srcline97"> 97</a></span><span class="line">        <span class="mxinfo " id="T13:U506"><span class="mxinfo " id="T13:U507"><span class="var type1" id="S16T40U646">pixrot</span>(<span class="mxinfo " id="T12:U509">2</span>,<span class="mxinfo " id="T14:U510">:</span>)</span> = <span class="mxinfo " id="T13:U511"><span class="mxinfo " id="T13:U512"><span class="mxinfo " id="T13:U513"><span class="var type1" id="S16T40U652">pixrot</span>(<span class="mxinfo " id="T1:U515">2</span>,<span class="mxinfo " id="T14:U516">:</span>)</span> + <span class="var type1" id="S3T9U655">H</span></span>+<span class="mxinfo " id="T1:U518">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,98" id="srcline98"> 98</a></span><span class="line">        <span class="mxinfo " id="T40:U519"><span class="var type1" id="S16T40U659">pixrot</span>      = <span class="mxinfo " id="T40:U521"><span class="var type1" id="S16T40U661">pixrot</span>(<span class="mxinfo " id="T50:U523">:</span>, <span class="mxinfo " id="T115:U524"><span class="mxinfo " id="T115:U525"><span class="mxinfo " id="T115:U526">(<span class="mxinfo " id="T115:U527"><span class="mxinfo " id="T1:U528">1</span> &lt;= <span class="mxinfo " id="T13:U529"><span class="var type1" id="S16T40U670">pixrot</span>(<span class="mxinfo " id="T1:U531">1</span>,<span class="mxinfo " id="T14:U532">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T115:U533"><span class="mxinfo " id="T13:U534"><span class="var type1" id="S16T40U676">pixrot</span>(<span class="mxinfo " id="T1:U536">1</span>,<span class="mxinfo " id="T14:U537">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U538"><span class="mxinfo " id="T9:U539">2*<span class="var type1" id="S4T9U682">W</span></span>+<span class="mxinfo " id="T1:U541">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T115:U542"><span class="mxinfo " id="T1:U543">1</span> &lt;= <span class="mxinfo " id="T13:U544"><span class="var type1" id="S16T40U688">pixrot</span>(<span class="mxinfo " id="T1:U546">2</span>,<span class="mxinfo " id="T14:U547">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T115:U548"><span class="mxinfo " id="T13:U549"><span class="var type1" id="S16T40U694">pixrot</span>(<span class="mxinfo " id="T1:U551">2</span>,<span class="mxinfo " id="T14:U552">:</span>)</span> &lt;= <span class="mxinfo " id="T9:U553"><span class="mxinfo " id="T9:U554">2*<span class="var type1" id="S3T9U700">H</span></span>+<span class="mxinfo " id="T1:U556">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,99" id="srcline99"> 99</a></span><span class="line">        <span class="mxinfo " id="T40:U557"><span class="var type1" id="S16T40U704">pixrot</span>      = <span class="mxinfo " id="T40:U559">round(<span class="var type1" id="S16T40U707">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,100" id="srcline100">100</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,101" id="srcline101">101</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,102" id="srcline102">102</a></span><span class="line">        <span class="mxinfo " id="T15:U561"><span class="var type1" id="S18T15U710">index</span> = <span class="mxinfo " id="T15:U563">sub2ind(<span class="mxinfo " id="T8:U564">[<span class="mxinfo " id="T9:U565"><span class="mxinfo " id="T9:U566">2*<span class="var type1" id="S3T9U718">H</span></span>+<span class="mxinfo " id="T1:U568">1</span></span>, <span class="mxinfo " id="T9:U569"><span class="mxinfo " id="T9:U570">2*<span class="var type1" id="S4T9U723">W</span></span>+<span class="mxinfo " id="T1:U572">1</span></span>]</span>, <span class="mxinfo " id="T13:U573"><span class="var type1" id="S16T40U726">pixrot</span>(<span class="mxinfo " id="T12:U575">2</span>,<span class="mxinfo " id="T14:U576">:</span>)</span>, <span class="mxinfo " id="T13:U577"><span class="var type1" id="S16T40U730">pixrot</span>(<span class="mxinfo " id="T12:U579">1</span>,<span class="mxinfo " id="T14:U580">:</span>)</span> )</span></span>;     </span></span>
<span class="srcline"><span class="lineno"><a href="104,103" id="srcline103">103</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,104" id="srcline104">104</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,105" id="srcline105">105</a></span><span class="line">        <span class="mxinfo " id="T15:U581"><span class="mxinfo " id="T15:U582"><span class="var type1" id="S2T4U736">TEMPLATE</span>(<span class="var type1" id="S18T15U737">index</span>)</span> = <span class="mxinfo " id="T9:U585">rad2deg(<span class="var type1" id="S9T9U740">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="104,106" id="srcline106">106</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,107" id="srcline107">107</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="104,108" id="srcline108">108</a></span><span class="line">    <span class="comment">%% fill in holes</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T4:U587"><span class="var type1" id="S2T4U743">TEMPLATE</span> = <span class="mxinfo " id="T4:U589">imdilate( <span class="var type1" id="S2T4U746">TEMPLATE</span>, ones(<span class="mxinfo " id="T1:U591">3</span>,<span class="mxinfo " id="T1:U592">3</span>) )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,110" id="srcline110">110</a></span><span class="line">    <span class="mxinfo " id="T4:U593"><span class="mxinfo " id="T4:U594"><span class="var type1" id="S2T4U754">TEMPLATE</span>(<span class="mxinfo " id="T13:U596"><span class="mxinfo " id="T9:U597">1</span>:<span class="mxinfo " id="T9:U598"><span class="var type1" id="S3T9U758">H</span>+<span class="mxinfo " id="T1:U600">2</span></span></span>,<span class="mxinfo " id="T14:U601">:</span>)</span> = <span class="mxinfo " id="T1:U602">-<span class="mxinfo " id="T1:U603">180</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="104,111" id="srcline111">111</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,112" id="srcline112">112</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
